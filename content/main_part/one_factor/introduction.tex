\chapter{Single-factor authentication}

% TODO Challenge-Response, Zero Knowledge, NONCE

\section{Threats}
\label{sec:one-factor-threats}

\subsection{Knowledge}

\frqq Passwords are both the bane and the foundation of [...] security\flqq{},\footcite[206]{517355} yet the most used authentication method remains knowledge, in \gls{it}, especially passwords.\footcite[See][424]{320284} While it seems the simplest method to use, it comes with many downsides, too. The service providers expect the user to remember the knowledge; nevertheless, the human brain has difficulty remembering a unique and secure password, \gls{pin}, or secret questions for every different account the user has registered. The average amount of different internet accounts a user has is ten or more, not including, e.g., credit card \glspl{pin}.\footcites[See][7, 9]{lastpass}\\
Because of this fact, the user often does a couple of insecure things:

\begin{enumerate}[label=(\alph*)]
	\item using the same secret knowledge for multiple accounts or variations of the same knowledge\footcites[See][8]{yougov}[See][14]{sweden-passwords}[See][7]{lastpass}
	\item using something easy to guess or knowledge that is tied to a personal object, such as birthdays, or names\footcite[See][]{web-de-passwords}
	\item writing down the username and passwords, e.g., on a piece of paper that's accessible easily for others, storing \glspl{pin}, e.g., in the briefcase or saving an unencrypted file on their computer or smartphone\footcites[See][]{web-de-passwords}[See][6]{yougov2}

\end{enumerate}

This enables an attacker to steal the login credentials of a user easily. Written down post-it notes enable any physical attacker to steal the credentials; it might be captured by a camera, too. Leaving an unencrypted file on the computer enables computer viruses and trojans to send the file to an attacker; mobile devices are affected, too, since, e.g., mobile trojans exist, too.\\
When using a weak passwords, an attacker might be able to just guess the chosen password. Writing down the banking \gls{pin} and storing it in the same briefcase as the credit card even annuls the \gls{2fa} example of possession and knowledge.

\begin{figure}[h]
	\begin{bchart}[min=5, max=55, step=10, unit=\%, scale=1.2]
		\bcbar[label=All passwords, color=red]{7}
		\medskip
		\bcbar[label=Most of the passwords, color=red]{20}
		\medskip
		\bcbar[label=Some passwords, color=red]{45}
		\bigskip
		\bcbar[label=Don't know, color=yellow]{7}
		\bigskip
		\bcbar[label=None of the passwords, color=green!50]{20}
	\end{bchart}
	\caption[Percentage of password re-usage in the United States in 2018]{Percentage of password re-usage in the United States in 2018\footnotemark}
	\label{fig:us-password-reuse}
\end{figure}
\footcitetext[Source:][8]{yougov}

\autoref{fig:us-password-reuse} shows a representative study of password re-usage in the United States in 2018 conducted by YouGov. In the survey over 70\% of all participants answered that they at least re-use some of their password for different accounts. Only 20\% of the participants use a unique password for every service. The survey is further classified into age, genders. While there is only a marginal difference between the genders the survey is showing that the password re-usage rate in the age group 18 to 34 is 79\% in total, weakening the potential argument that younger people tend to be more aware of the risks of stolen credentials and therefore use more complex and more different passwords. Other surveys strengthen the observation that millennials are the re-using passwords more often.\footcites[See][10]{ibm-security}[See][8]{yougov}[See][11]{lastpass}[See][1429]{Thomas:2017:DBP:3133956.3134067}

Regarding the security of security and/or recovery questions, it must be noted that these might even decrease security. Relatives and friends can answer common examples of questions such as the \frqq middle name or birth name of a parent, name of the first pet, model of the first car, where did your parents meet\flqq{}, enabling a malicious insider attack. Some questions might be answerable by employing a social engineering attack, too. Besides that, data can even be gathered by using, e.g., data mining of publicly available data sources and reports. Additionally, it is not uncommon to be able to guess the partner's password.\footcites[See][11]{lastpass}[See][169]{Brainard2006}[See][]{Bonneau:2015:SLA:2736277.2741691}[See][5--6]{Rabkin:2008:PKQ:1408664.1408667}

Further, especially true for passwords, it's not known to the user what the service provider does in order to protect the security of the passwords. As security breaches happen nearly on a daily basis, it's important to protect the password of the user. For instance, if the passwords are stored in a database, they can be:

\begin{enumerate}[label=(\alph*)]
	\item unencrypted (worst case)
	\item hashed, but not salted
	\item hashed and salted (best case)
	\item encrypted
\end{enumerate}

It is pretty obvious that unencrypted passwords in a database render the biggest threat, especially when re-used. Along with the e-mail or username an attacker can probably use the stolen credentials for other accounts, too, or in case of an e-mail provider breach, just re-issue a new password with the \frqq forgotten password\flqq{} mechanism.\footcite[See][277]{shostack2014threat}

Even if the password is hashed, but not salted, it renders the credentials at risk. Weaker hashing algorithms such as MD5 or SHA1 might be broken in the future, but besides that if it's a weak password, too, the hash might already been reversed. Having the hashed password list, enables the attacker to execute a brute force attack in order to reverse as many hashes, as possible, a rainbow table attack, dictionary attack or just searching it in databases that contain billion of reversed hash values.\footcites[See][1425]{Thomas:2017:DBP:3133956.3134067}[See][427--430]{320284}[See][56--57]{anderson2008security}

The best protection is a unique salt for each password, which decreases the risk of a successful rainbow or brute force attack dramatically. In this scenario each password is not only hashed, but salted, too. A salt is a fixed-length cryptographically-strong or random value or a \gls{nonce} that is concatenated with the actual password in order to avoid having the same hashes even when two users have chosen the same password.\footcites[See][32--34]{IdentityandDataSecurityforWebDevelopment}[See][130--131]{brotherston2017defensive}

	
\subsection{Possession}
\label{subsec:possession-threat}

The primary risks of authentication by possession are that it is not tied to the user itself and can be lost or even worse stolen by an attacker. Besides, that possession factors can be shared between multiple users, allowing attacks such as a malicious insider attack. Often the possession factors are not protected itself so, e.g., a keycard to open a door can be used by the attacker, too.

Another usage implication is that it must be carried with the user and can be forgotten which makes the authentication impossible if no access to the possession is possible and no backup or different authentication methods are available. Another risk is that possession can be damaged or destroyed. For example, carrying security keys on a keyring exposes them to damage by a fall or liquids.\footcites[See][263--264]{shostack2014threat}

Especially possessions that use wireless transmissions such as \gls{ble}, \gls{nfc}, or \gls{rfid} can be copied even over some distances. For instance, an attacker could copy credit cards in crowded places such as trains or buses.\footcite[See][]{6892730}

Compared with knowledge, a replacement is more costly, complex and time-consuming (e.g., when a passport is lost or stolen). If for example a whole algorithm is broken, such as the first generation of RSA SecureID or some YubiKey models happened to be vulnerable, it can cause severe problems depending on the amount of keys that need to be replaced.\footcites[See][18]{dasgupta2017multi}[See][]{BIRYUKOV2005364}[See][]{yubikey-heise}

\subsection{Biometrics}

In contrast to possession and knowledge, the biometric trait cannot easily be stolen. While it can be copied, e.g. the fingerprint from high-resolution photographs or 
face models to circumvent face recognition systems.\footcites[][]{185181}[][]{220566} In the recent past, researchers could copy both German Chancellor's Angela Merkel's iris and the fingerprint of Ursula von der Leyen, the now the elected President of the European Commission, from high-resolution photographs.\footcite{ccc-merkel} It must be taken into account though, that especially the so-called latent fingerprints are nearly left everywhere, i.e., the security of biometrics heavily relies on the chosen biometric trait.\footcite[See][299]{Vacca2017aa}

Further implications are that the biometric characteristics can change over time or be temporarily unavailable because of injuries. While some can heal over time, others, especially scars, can permanently change the biometric trait and therefore render it unusable. Also, each time the user authenticates with biometrics, a new sample of the trait is gathered and compared to the stored one. Because the recent probe will never be 100\% identical compared to the stored one (\frqq intra-user variants\flqq), a threshold needs to be defined, which allows or denies the authentication attempt. Setting the threshold to a too low value increases the risk of the \gls{far}, while a too high value decreases the usability and increases the \gls{frr}.\footcite[See][13--17, 52]{Jain2011}\\Traits such as facial recognition must also be usable with different amounts of facial hair, hairstyles, with and without glasses.\footcite[See][98]{Jain2011}

Another high risk is data privacy and security. Over 50\% of the users fear about data usage, both legitimate and abusive, and collection of their biometrics, yet the majority of the user states that biometrics is the most secure authentication compared to, e.g., passwords and \glspl{pin}.\footcite[See][8]{ibm-security} It is crucial that the stored biometric probe is not accessible by third parties nor shared with them. For example, a theft of smartphones should not mean theft of the biometrics, e.g., fingerprint, too.

However the major threat remains the difficulty to replace a compromised biometric template. While, e.g., a password or a security key can be changed or replaced, for instance a fingerprint can't be altered, changed or replaced since it remains the same for the whole lifespan of a person. To counter this threat it is advised to use, for instance, only a hash of the fingerprint and not store the \textit{image} of the fingerprint itself.\footcite[See][266]{shostack2014threat}

Further, it is necessary to respect the quality and availability of the sensor. If a sensor is damaged, too cheap or the surface is, for example, dirty, then the authentication and especially the usability suffers.\footcite[See][37]{265831}

\subsection{Further methods}

A high risk of location-based authentication is the spoofing of the actual location by an attacker. An attacker can choose different attack vectors, such as spoofing the source IP address that tries to access a system. Another form of spoofing is the \gls{gps} spoofing where an attacker modifies the actual \gls{gps} by broadcasting false information. Further, the Caller ID spoofing technique can be used with \gls{voip} to disguise the location. Besides these techniques, the most common variant remains the usage of a \gls{vpn} network or \gls{dns} proxy to hide the genuine location.\footcites[See][138--145]{517355}[See][Chapter 4.5.3]{30270}[See][115--116,133]{eckert-it-sec-9}

For time-based authentication, an attacker could use attacks against the \gls{ntp} in order to either gain access of the verification system or to modify the synchronized time in order to allow the login attempt to succeed.\footcite[See][]{malhotraattacking}

\subsection{General threats}

Besides the specific risk and threats that affect each of the authentication methods there are some general threats and risks that are some independent risks, such as the enrollment or the transmission of the authentication data. The following sections take these risk into account, too.

\subsubsection{Initialization/Registration/Enrollment}

A more general threat is the registration or initialization of the authentication. The user has to make sure that no attacker can intercept or copy the required enrollment data. For instance, if malware comprises a user’s computer and installs a keylogger, then an entered password is no longer a secret and is compromised. A computer virus could also intercept a USB connection from a security key, both when registering the device and while using it. Furthermore, the user needs to make sure that his enrollment process is not observed from, e.g., a surveillance camera, a hacked webcam, or a colleague from behind. Mobile phones are subject to trojans, too, enabling the risk that for instance the camera is intercepted and a scanned \gls{qr} code that contains enrollment data for \gls{totp} is sent to an attacker. With the recent rise of \gls{iot} devices, e.g., the mentioned security cameras might be compromised by an attacker.\footcites[See][152--153]{10.1007/978-3-642-39235-1_9}[See][61]{Ulqinaku:2019:FPP:3317549.3323404}[See][371--375]{10.1007/978-3-662-45472-5_24}
% TODO some more sources

\subsubsection{Transmission}

Further, the chosen transmission channel is an important fact to take into account. Entering a password on an unencrypted site (HTTP) enables network sniffing where the password is transmitted in cleartext. Especially public Wi-Fi hotspots are a lucrative target, especially when the user is accepting custom SSL certificates which enable the attacker to perform an \gls{mitm} attack and even steal the passwords that are sent via an encrypted channel. The risk also applies to other authentication methods, too. A manipulated USB port could try to copy the data on a security key, or a tampered sensor can capture the fingerprint of a user. \gls{sms} traffic is at high risk of being intercepted (e.g., for the transmission of \glspl{pin} or \glspl{tan}) as well as unencrypted email traffic containing, e.g., password or \glspl{totp}.
