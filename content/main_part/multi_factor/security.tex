\chapter{Security of Multi-Factor Authentication}

\section{Introduction}

This chapter analyses the introduced \gls{mfa} solutions in regards to their security aspects, ranging from algorithms and transportation threats, past vulnerabilities to implementation pitfalls.

\autoref{fig:2fa_flow_phishing} on the next page shows the already in \autoref{fig:2fa_flow} explained \gls{mfa} flow using a \gls{totp}. In this figure, the scenario is expanded by a phishing attack. The user visits a phishing copy of the website they want to use and does not notice this. They enter their password, an attacker intercepts it and then forwards it to the legitimate service. Since the user is aware that this site is using \gls{mfa}, they provide the \gls{totp} to the phishing site, too. This allows the interceptor to steal both the password (knowledge as the first factor) and \gls{totp} (possession as the second factor). In turn, an attacker can now successfully log in to the victim's account and effectively bypass the \gls{mfa} solution. This scenario does not explicitly exploit a vulnerability but instead uses the conceptual weakness of an \gls{mfa} solution, since it is not phishing resistant.\footcites[See][61]{Ulqinaku:2019:FPP:3317549.3323404}

\newpage

\begin{figure}[hbt]
	\centering
	\includesvg[width=\textwidth,pretex=\relscale{1}]{pics/svg/2fa_flow_phishing}
	\caption[Exemplary phishing of an \gls{otp} with \gls{2fa} enabled]{Exemplary phishing of an \gls{otp} with \gls{2fa} enabled\footnotemark}
	\label{fig:2fa_flow_phishing}
\end{figure}
\footnotetext{Source: diagram by author}

\section{One-Time Passwords}
\label{sec:totp_sec}

This section analyzes the security of both \gls{hotp} and \gls{totp} by taking their specifications into account, mainly the underlying hash functions and synchronization features. However, also the generation and transmission of the \gls{otp}, which is not part of the specification, are considered.

\input{content/main_part/multi_factor/totp/security}

\section{Smart Cards and Security Tokens}
\label{sec:tokens}

\input{content/main_part/multi_factor/tokens/security}

\section{Universal Second Factor}
\label{sec:u2f}

\input{content/main_part/multi_factor/fido/security}
