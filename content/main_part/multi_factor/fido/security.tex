The security of the \gls{u2f} protocol extends the security threats of physical security tokens and smartcards that were introduced in the previous section, for example, loss or theft.\footcites[See][12--13]{fido-sec-ref}

In contrast to \gls{otp}, the \gls{u2f} protocol is phishing resistant. This resistance is achieved by binding the token, registration, and authentication to a specific origin. Given the fact \gls{u2f} token compares the origin, phishing sites that target, e.g., typos in the \gls{url} do not expose a threat.

However, the \gls{u2f} protocol is not resistant to malware. A malware that controls the \gls{usb} ports of a computer can communicate with the token, too.\footcites[See][10--1]{8429292}[See][9]{u2f-overview}

When using the \gls{tls} ChannelID, also called token binding, a possible extension of the \gls{u2f} protocol, the user is protected against \gls{mitm} attacks. Token binding enables mutual authentication in \gls{tls} by using cryptographic certificates on both sides. It has to be noted though, that using the \gls{tls} ChannelID is defined as optional in the specification.\footcites[See][6--7]{u2f-overview}

Security reachers were able to find a potential vulnerability in the optional key wrapping of the key material if the counters are not correctly increased and checked. This attack could lead to a successful cloning attack. The security token vendors and the \gls{fido} alliance since have adjusted the specification and recommendations. Further, researches were able to control the token via the Web\gls{usb} \gls{api} by emulating the \gls{nfc} capabilities of a YubiKey to use it as a smartcard.\footcites[See][3]{DBLP:journals/corr/abs-1906-06009}

Albeit it is not a vulnerability, the lack of a display on the authenticator can render a threat. An attacker might be able to change the transaction a user signs with the test of user presence. Further, the absence of a display might confuse a user if a registration or authentication was successful. Also, malware is able to continually request the touch of a button to complete a \gls{mfa} authentication flow with, e.g., phished or keylogged credentials. Due to the lack of a display, the chances are high that a user accidentally confirms a fraudulent authentication from the malware. Additionally, the user might not notice it and presses the button again due to the lack of feedback from the token.\footcites[See][434]{10.1007/978-3-662-54970-4_25}[See][15]{das2018johnny}[See][1518--1519]{238325}[See][884]{8418643}

In theory, an attacker could manufacture a backdoor variant of the \gls{u2f} token, which either leaks or sends all the private keys to the attacker. This attack has a low probability compared to the other attack vectors, though.\footcites[See][3]{DBLP:journals/corr/abs-1810-04660}

Moreover, the centralized managed metadata service for device attestation can expose a threat. Given an attacker takes over this server, they can either enable counterfeit security tokens to become legitimate attested tokens. On the other hand, legitimate tokens can be flagged as banned or compromised. Besides that, the service is subject to a \gls{ddos} attack that prevents \glspl{rp} from updating their metadata database. Since vendors offer their attestation metadata independently, mitigation is to implement an independent metadata service.\footcites[See][]{fido-metadata}[See][17]{Chang2017OnMU}
